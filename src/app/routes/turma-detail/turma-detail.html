@if (turma()) {
  <div class="max-w-lg mx-auto bg-gray-100 dark:bg-gray-900 p-4 font-sans space-y-3">
    <header class="mb-6">
      <h1 class="text-xl font-bold text-blue-800 dark:text-blue-300">{{ turma()!.nome }}</h1>
    </header>

    <div
      class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-3 dark:border dark:border-gray-700"
    >
      <h2
        class="text-lg font-semibold text-gray-800 dark:text-gray-100 border-b dark:border-gray-700 pb-1 mb-2"
      >
        Minhas Notas
      </h2>

      <div class="space-y-3">
        @if (turma()!.notas?.notas) {
          <div class="space-y-2">
            @for (nota of turma()!.notas?.notas | keyvalue; track nota.key) {
              <div
                class="flex justify-between items-center border-b dark:border-gray-700 last:border-b-0"
              >
                <span class="text-gray-600 dark:text-gray-400 font-medium text-sm">
                    {{ nota.key }}:
                </span>
                <span [class]="`text-md font-bold ${Number(nota.value.replace(',', '.')) < 6 ? 'text-red-800' : Number(nota.value.replace(',', '.')) > 8 ? 'text-green-700' : 'text-orange-400'}`">
                  {{ nota.value }}
                </span>
              </div>
            }
          </div>
        } @else {
          <p class="text-gray-500 dark:text-gray-400 text-sm text-center italic">
            Nenhuma nota parcial registrada.
          </p>
        }
      </div>
    </div>

    <div
      class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-3 dark:border dark:border-gray-700"
    >
      <h2
        class="text-lg font-semibold text-gray-800 dark:text-gray-100 border-b dark:border-gray-700 pb-1 mb-2"
      >
        Frequência
      </h2>

      <div class="space-y-3">
        <div class="space-y-2">
          <div class="flex justify-between items-center text-sm">
            <span class="text-gray-600 dark:text-gray-400 font-medium">Faltas:</span>
            <span class="font-medium text-red-800 dark:text-red-800">{{
              parseFaltas(turma()!.faltas)
            }}</span>
          </div>
        </div>
      </div>
    </div>

    <div
      class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-3 dark:border dark:border-gray-700"
    >
      <h2
        class="text-lg font-semibold text-gray-800 dark:text-gray-100 border-b dark:border-gray-700 pb-2 mb-2"
      >
        Próximas Avaliações
      </h2>

      <div class="space-y-3">
        @for (
          avaliacao of avaliacoesDaTurma();
          track avaliacao.data + avaliacao.nome + avaliacao.tipo + avaliacao.turmaNome
        ) {
          <div class="space-y-3">
            <div
              class="p-2 space-y-1 bg-blue-50 dark:bg-blue-900/50 rounded-md border border-blue-200 dark:border-blue-700"
            >
              <p class="text-sm font-semibold text-blue-800 dark:text-blue-200">
                {{ avaliacao.nome }} ({{ avaliacao.tipo }})
              </p>
              <p class="text-xs text-gray-700 dark:text-gray-300">Data: {{ avaliacao.data }}</p>
            </div>
          </div>
        } @empty {
          <p class="text-gray-500 dark:text-gray-400 text-sm">
            Nenhuma avaliação agendada para esta turma.
          </p>
        }
      </div>
    </div>

    <div
      class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-3 dark:border dark:border-gray-700"
    >
      <h2
        class="text-lg font-semibold text-gray-800 dark:text-gray-100 border-b dark:border-gray-700 pb-2 mb-2"
      >
        Horários
      </h2>

      <div classs="space-y-2">
        <div
          class="text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-700 p-2 rounded-md text-sm font-normal"
        >
          {{ formatarHorarios(turma()!.horarios) }}
        </div>
      </div>
    </div>

    @if (turma()!.noticia.titulo.length) {
      <div
        class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-3 dark:border dark:border-gray-700"
      >
        <h2
          class="text-lg font-semibold text-gray-800 dark:text-gray-100 border-b dark:border-gray-700 pb-2 mb-2"
        >
          Notícia da Turma
        </h2>
        <h3 class="font-medium text-gray-900 dark:text-gray-100 mb-2">
          {{ turma().noticia.titulo }}
        </h3>
        <div class="prose prose-sm dark:prose-invert text-gray-700 dark:text-gray-300 break-words">
          @for (paragrafo of turma().noticia.conteudo; track paragrafo) {
            <p>{{ paragrafo }}</p>
          }
        </div>
      </div>
    }

    @if (turma()!.cronograma && turma()!.cronograma!.length) {
      <div
        class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-3 dark:border dark:border-gray-700"
      >
        <h2
          class="text-lg font-semibold text-gray-800 dark:text-gray-100 border-b dark:border-gray-700 pb-2 mb-2"
        >
          Cronograma
        </h2>
        <ul class="space-y-1">
          @for (item of turma()!.cronograma; track $index) {
            <li class="flex items-start space-x-3 border-b border-gray-600 pb-2 last:border-b-0">
              <div
                class="flex-shrink-0 h-1.5 w-1.5 bg-blue-500 dark:bg-blue-400 rounded-full mt-[7px]"
              ></div>
              <div>
                <h4 class="text-base font-semibold text-gray-800 dark:text-gray-100">{{ item.titulo }}</h4>
                <p class="text-sm text-gray-600 dark:text-gray-400">{{ item.conteudo }}</p>
              </div>
            </li>
          }
        </ul>
      </div>
    }
  </div>
}
